---
- hosts: localhost
  connection: local
  vars:
     nios_provider:
        host: 10.2.10.160
        username: awx-automation
        password: test_321!
        validate_certs: no
   
  tasks:

    - name: Create a network on the default network view
      infoblox.nios_modules.nios_network:
        network: 10.17.112.0/24
        comment: sets the IPv4 network options
        state: present
        provider: "{{nios_provider}}"

    - name: Create a new zone
      infoblox.nios_modules.nios_zone:
        name: example.com
        view: default
        state: present
        provider: "{{nios_provider}}"

    - name: Configure an IPv4 host record
      infoblox.nios_modules.nios_host_record:
        name: example.com
        ipv4addrs:
          - ipv4addr: 10.17.112.5
        state: present
        provider: "{{nios_provider}}"

    - name: Configure an A record
      infoblox.nios_modules.nios_a_record:
        name: abb.example.com
        ipv4: 10.17.112.5
        state: present
        provider: "{{nios_provider}}"
